#!/bin/sh
command="${1}" shift;
args="${@}"
toolbox="$(dirname -- "${BASH_SOURCE[0]}")/../"
help="Usage: tb [commands...]
Tools:
  [command] [args] eg: curl google.com

Toolbox:
  build     Build toolbox container image
  enter     Exec into container interactively
  help      This menu
  list      List all tools available
  "

function docker_cleanup () {
  docker rm toolbox > /dev/null
}

function docker_execute () {
  [ "${interactive}" == true ] && interactive="-it"
  docker run ${interactive} -v $(pwd):/home/toolbox/host --name toolbox toolbox ${command} ${args}
  docker_cleanup
}

case ${command} in
  *help)
    echo "${help}"
    exit
    ;;
  build)
    docker build -t toolbox ${toolbox}
    exit
    ;;
  list)
    command="bash toollist"
    ;;
  enter)
    command="bash"
    interactive=true
    ;;
  mtr)
    interactive=true
    ;;
esac

docker_execute